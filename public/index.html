<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="theme-color" content="#000000" />
    <!--
      manifest.json provides metadata used when your web app is added to the
      homescreen on Android. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json?%REACT_APP_RELEASE%" />
    <link rel="stylesheet" href="%PUBLIC_URL%/index.css?%REACT_APP_RELEASE%" />
    <link
      href="https://fonts.googleapis.com/css?family=Almendra|Space+Mono|Vesper+Libre&subset=latin-ext"
      rel="stylesheet"
    />

    <title>Personal Idol</title>
  </head>
  <body>
    <div id="root">
      <noscript class="dd__noscript">
        <div class="dd__loader dd__loader--app-setup dd__loader--error">
          <p class="dd__loader__error-message">
            You need to enable JavaScript to run this application.
          </p>
          <p>
            <a href="https://www.wikihow.com/Enable-JavaScript">
              How do I enable JavaScript?
            </a>
          </p>
        </div>
      </noscript>
      <div class="dd__loader dd__loader--app-setup dd__loader--hidden" id="root-loader">
        Checking browser capabilities...
      </div>
      <div class="dd__loader dd__loader--app-setup dd__loader--error dd__loader--hidden" id="root-error">
        <div class="dd__loader__content dd-tp__formatted-text">
          <strong class="dd__loader__error-message">
            Your browser is not capable of running this application.
          </strong>
          <p>
            I am using latest web development technologies to provide the most optimal and safe experience possible (or
            at least the best possible for me to provide ðŸ™‚). I want to do that without using any kind of coding tricks
            or polyfills to overcome browser limitations (or at least keep them at minimum) and instead to rely on
            native browser features.
          </p>
          <p>
            Thanks to that I also want to make sure that the app will be experienced under optimal conditions and never
            in a degraded state.
          </p>
          <p>
            Sorry for not letting you try to run this app nonetheless, but I am completely sure that without those
            required features it will break anyway.
          </p>
          <p>It is recommended to use the <strong>latest</strong> version of any of these browsers:</p>
          <nav class="dd__loader__recommended-browsers">
            <a class="dd__loader__recommended-browsers__browser" href="https://www.google.com/chrome/">
              <img src="https://cdnjs.cloudflare.com/ajax/libs/browser-logos/58.1.3/chrome/chrome_64x64.png" />
            </a>
            <a class="dd__loader__recommended-browsers__browser" href="https://www.mozilla.org/en-US/firefox/">
              <img src="https://cdnjs.cloudflare.com/ajax/libs/browser-logos/58.1.3/firefox/firefox_64x64.png" />
            </a>
            <a class="dd__loader__recommended-browsers__browser" href="https://www.apple.com/lae/safari/">
              <img src="https://cdnjs.cloudflare.com/ajax/libs/browser-logos/58.1.3/safari/safari_64x64.png" />
            </a>
          </nav>
          <p>
            If your are not interested in using any of the above, you can always pick your own browser, but it has to
            fully support those technical features:
          </p>
          <details class="dd__browser-details">
            <p>
              âœ“ - your current browser supports this one
            </p>
            <p>
              Click feature name for more info.
            </p>
            <ul class="dd__browser-features">
              <li class="dd__browser-feature" id="browser-feature-flexbox">
                <a href="https://caniuse.com/#feat=flexbox">
                  CSS Flexible Box Layout Module (for UI rendering)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-cssgrid">
                <a href="https://caniuse.com/#feat=css-grid">
                  CSS Grid Layout (for UI rendering)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-customelements">
                <a href="https://caniuse.com/#feat=mdn-api_window_customelements">
                  Custom Elements (for 3D scene rendering)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-es5">
                <a href="https://caniuse.com/#feat=es5">
                  ECMAScript 5 (coding features)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-es6">
                <a href="https://caniuse.com/#feat=es6">
                  ECMAScript 6 (coding features)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-fetch">
                <a href="https://caniuse.com/#feat=fetch">
                  Fetch (coding feature)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-intl">
                <a href="https://caniuse.com/#feat=mdn-javascript_builtins_intl">
                  Intl (browser extension for internationalization)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-passiveeventlisteners">
                <a href="https://caniuse.com/#feat=passive-event-listener">
                  Passive event listeners (coding feature)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-promises">
                <a href="https://caniuse.com/#feat=promises">
                  Promises (coding feature)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-serviceworker">
                <a href="https://caniuse.com/#search=serviceworker">
                  Service Workers (for progressive web apps and offline caching)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-srcset">
                <a href="https://caniuse.com/#search=srcset">
                  Srcset and sizes attributes (for image loading optimization)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-webworkers">
                <a href="https://caniuse.com/#feat=webworkers">
                  Web Workers (for performance)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-webgl">
                <a href="https://caniuse.com/#feat=webgl">
                  WebGL (for 3D scene rendering)
                </a>
              </li>
              <li class="dd__browser-feature" id="browser-feature-webrtc">
                <a href="https://caniuse.com/#feat=rtcpeerconnection">
                  WebRTC (for P2P chat between players)
                </a>
              </li>
            </ul>
          </details>
        </div>
      </div>
    </div>
    <script>
      (function() {
        document.getElementById("root-loader").classList.remove("dd__loader--hidden");
      })();
    </script>

    <script src="%PUBLIC_URL%/vendor/modernizr.js"></script>
    <script>
      (function() {
        "use strict";

        var rootElement = document.getElementById("root");
        var requiredBrowserFeatures = {
          cssgrid: "cssgrid",
          customelements: "customelements",
          datachannel: "webrtc",
          es5: "es5",
          es6array: "es6",
          es6collections: "es6",
          es6math: "es6",
          es6number: "es6",
          es6object: "es6",
          es6string: "es6",
          fetch: "fetch",
          flexbox: "flexbox",
          generators: "es6",
          intl: "intl",
          passiveeventlisteners: "passiveeventlisteners",
          peerconnection: "webrtc",
          promises: "promises",
          serviceworker: "serviceworker",
          srcset: "srcset",
          webgl: "webgl",
          webworkers: "webworkers",
        };
        var allFeatures = 0;
        var doneFeatures = 0;
        var feature = void 0;
        var isCapable = true;

        var notSupportedClassName = "dd__browser-feature--not-supported";
        var supportedClassName = "dd__browser-feature--supported";

        for (feature in requiredBrowserFeatures) {
          if (requiredBrowserFeatures.hasOwnProperty(feature)) {
            allFeatures += 1;

            Modernizr.on(
              feature,
              (function(thisFeature) {
                return function(result) {
                  var isFeatureSupported = result;

                  isCapable = isCapable && isFeatureSupported;
                  doneFeatures += 1;

                  document
                    .getElementById("browser-feature-" + requiredBrowserFeatures[thisFeature])
                    .classList.add(isFeatureSupported ? supportedClassName : notSupportedClassName);

                  if (doneFeatures < allFeatures) {
                    return;
                  }

                  if (isCapable) {
                    rootElement.classList.add("js-dd-capable");
                  } else {
                    rootElement.classList.add("js-dd-incapable");
                    document.getElementById("root-loader").classList.add("dd__loader--hidden");
                    document.getElementById("root-error").classList.remove("dd__loader--hidden");
                  }
                };
              })(feature)
            );
          }
        }
      })();
    </script>
  </body>
</html>
